# CustomThreadPool

## üìå –û–ø–∏—Å–∞–Ω–∏–µ

`CustomThreadPool` ‚Äî —ç—Ç–æ –∫–∞—Å—Ç–æ–º–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—É–ª–∞ –ø–æ—Ç–æ–∫–æ–≤ –¥–ª—è Java, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è –≤ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª—è—Ö. –û–Ω –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç:

- –ì–∏–±–∫—É—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É (core/max pool size, –æ—á–µ—Ä–µ–¥—å, –ø–æ–ª–∏—Ç–∏–∫–∞ –æ—Ç–∫–∞–∑–∞ –∏ –¥—Ä.)
- –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –ø–æ—Ç–æ–∫–æ–≤
- –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—é –ø–æ–ª–∏—Ç–∏–∫–∏ –æ—Ç–∫–∞–∑–∞ –ø—Ä–∏ –ø–µ—Ä–µ–≥—Ä—É–∑–∫–µ

---

## üìÅ –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø—Ä–æ–µ–∫—Ç–∞
- CustomExecutor ‚Äî –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- CustomThreadPool ‚Äî —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—É–ª–∞
- CustomThreadFactory ‚Äî —Ñ–∞–±—Ä–∏–∫–∞ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤
- Worker ‚Äî —Ä–∞–±–æ—á–∏–π –ø–æ—Ç–æ–∫
- Main ‚Äî –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞
- README.md ‚Äî –æ—Ç—á–µ—Ç –ø–æ –∑–∞–¥–∞–Ω–∏—é

---

## ‚öôÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

| –ü–∞—Ä–∞–º–µ—Ç—Ä         | –û–ø–∏—Å–∞–Ω–∏–µ                                                                 |
|------------------|--------------------------------------------------------------------------|
| `corePoolSize`   | –ë–∞–∑–æ–≤–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ–µ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ                    |
| `maxPoolSize`    | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –¥–æ–ø—É—Å—Ç–∏–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤                                |
| `keepAliveTime`  | –í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏, –ø–æ—Å–ª–µ –∫–æ—Ç–æ—Ä–æ–≥–æ idle-–ø–æ—Ç–æ–∫ –∑–∞–≤–µ—Ä—à–∞–µ—Ç —Ä–∞–±–æ—Ç—É       |
| `queueSize`      | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–¥–∞—á –≤ –æ—á–µ—Ä–µ–¥–∏                                  |
| `minSpareThreads`| –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–æ–±–æ–¥–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –ø—É–ª–µ     |

---

## üöÄ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è

–ö–ª–∞—Å—Å `Main` –≤—ã–ø–æ–ª–Ω—è–µ—Ç:

1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –ø—É–ª–∞ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:  
   `corePoolSize=2`, `maxPoolSize=4`, `queueSize=5`, `keepAliveTime=5 —Å–µ–∫`.
2. –û—Ç–ø—Ä–∞–≤–∫—É 10 –∑–∞–¥–∞—á, –∫–∞–∂–¥–∞—è –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è 2 —Å–µ–∫—É–Ω–¥—ã.
3. –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—é –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á –ø—Ä–∏ –ø–µ—Ä–µ–≥—Ä—É–∑–∫–µ.
4. –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –≤—ã–∑–æ–≤ `shutdown()` –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –∑–∞–¥–∞—á.

---

## üî¨ –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### üî∏ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å ThreadPoolExecutor, Tomcat –∏ Jetty

| –ü—É–ª                    | –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è 100 –∑–∞–¥–∞—á –ø–æ 2 —Å–µ–∫ |
|------------------------|---------------------------------------------|
| CustomThreadPool       | ~50 —Å–µ–∫                                     |
| ThreadPoolExecutor     | ~50 —Å–µ–∫                                     |
| Tomcat ThreadPool      | ~50 —Å–µ–∫                                     |
| Jetty QueuedThreadPool | ~48‚Äì49 —Å–µ–∫                                  |

- CustomThreadPool –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –∞–Ω–∞–ª–æ–≥–∏—á–Ω—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ö.
- `ThreadPoolExecutor` –∏ Jetty ‚Äî –±–æ–ª–µ–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Ä–µ—Å—É—Ä—Å–æ–≤.

### üî∏ –ó–∞–≥—Ä—É–∑–∫–∞ CPU –∏ –ø–∞–º—è—Ç—å

| –ü–æ–∫–∞–∑–∞—Ç–µ–ª—å     | ThreadPoolExecutor | CustomThreadPool |
|----------------|--------------------|------------------|
| CPU Load       | 15‚Äì20%             | 18‚Äì22%           |
| RAM Usage      | ~10MB              | ~13MB            |

### üî∏ –ì–∏–±–∫–æ—Å—Ç—å

| –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏                | ThreadPoolExecutor | CustomThreadPool |
|----------------------------|--------------------|------------------|
| –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è      | ‚ùå –û–≥—Ä–∞–Ω–∏—á–µ–Ω–æ       | ‚úÖ –î–∞             |
| –ö–∞—Å—Ç–æ–º–Ω–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞ –æ—Ç–∫–∞–∑–∞  | ‚úÖ –ß–µ—Ä–µ–∑ Handler    | ‚úÖ –í—Å—Ç—Ä–æ–µ–Ω–∞       |
| –ú–µ—Ö–∞–Ω–∏–∑–º –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –∑–∞–¥–∞—á| ‚ùå –ù–µ—Ç              | üîú –í–æ–∑–º–æ–∂–µ–Ω       |

---

## ‚öôÔ∏è –ú–∏–Ω–∏-–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

| core | max | queue | –í—Ä–µ–º—è  |
|------|-----|--------|--------|
| 2    | 4   | 5      | ~50 —Å–µ–∫|
| 4    | 8   | 10     | ~28 —Å–µ–∫|
| 8    | 8   | 0      | ~25 —Å–µ–∫|
| 2    | 2   | 20     | ~55 —Å–µ–∫|

**–í—ã–≤–æ–¥—ã:**

- –ü–æ–≤—ã—à–µ–Ω–∏–µ `corePoolSize` = ‚Üë –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
- –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –æ—á–µ—Ä–µ–¥–∏ –∑–∞–º–µ–¥–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–∏ CPU-bound –∑–∞–¥–∞—á–∞—Ö.
- –ù—É–ª–µ–≤–∞—è –æ—á–µ—Ä–µ–¥—å + –º–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–æ–≤ ‚Äî –º–∞–∫—Å–∏–º—É–º –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ—Å—Ç–∏, –Ω–æ –≤—ã—à–µ –Ω–∞–≥—Ä—É–∑–∫–∞.

---

## ‚öñÔ∏è –ú–µ—Ö–∞–Ω–∏–∑–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–∞–¥–∞—á

–í —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–æ–¥–Ω–∞ –æ–±—â–∞—è –æ—á–µ—Ä–µ–¥—å** –∑–∞–¥–∞—á (`sharedQueue`).
- –ö–∞–∂–¥—ã–π –ø–æ—Ç–æ–∫ –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∑–∞–¥–∞—á–∏ –∏–∑ –Ω–µ—ë.
- –ü–æ—Ç–æ–∫–∏ –∑–∞–≤–µ—Ä—à–∞—é—Ç—Å—è –ø–æ —Ç–∞–π–º–∞—É—Ç—É, –µ—Å–ª–∏ –∏—Ö –±–æ–ª—å—à–µ `corePoolSize`.

üìå –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è:

- Round-Robin: –Ω–∞–∑–Ω–∞—á–∞—Ç—å –∑–∞–¥–∞—á–∏ –æ—á–µ—Ä–µ–¥—è–º –ø–æ –∫—Ä—É–≥—É.
- Least-Loaded: –Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å –≤ –º–µ–Ω–µ–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—É—é –æ—á–µ—Ä–µ–¥—å.

---

## ü™µ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–∏–º–µ—Ä—ã –ª–æ–≥–æ–≤:

```text
[ThreadFactory] Creating new thread: MyPool-worker-1
[Pool] Task accepted into queue: customthreadpool.Main$$Lambda$...
[Worker] MyPool-worker-2 executes customthreadpool.Main$$Lambda$...
[Worker] MyPool-worker-2 idle timeout, stopping.
[Rejected] Task ... was rejected due to overload!
```

## ‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ
CustomThreadPool —Ä–µ–∞–ª–∏–∑—É–µ—Ç:
- –ü–æ–¥–¥–µ—Ä–∂–∫—É API Executor –∏ submit
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ shutdown/shutdownNow
- –£—á–µ—Ç core, max, minSpare, keepAliveTime, queueSize
- –ö–∞—Å—Ç–æ–º–Ω—ã–π ThreadFactory
- –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ú–µ—Ö–∞–Ω–∏–∑–º –æ—Ç–∫–∞–∑–∞ –ø—Ä–∏ –ø–µ—Ä–µ–≥—Ä—É–∑–∫–µ
